# solve xorror
if __name__ == '__main__':
    flag_enc = [8460772314775398290, 11281029753033864562, 406728620538917158, 6047243497055849560, 8460772314775398287, 5640514876516932266, 8867500935314315566, 2820257438258466097, 8460772314775398298, 6047243497055849563, 406728620538917154, 6047243497055849556, 11281029753033864530, 3226986058797383403, 3226986058797383406, 14101287191292330527, 406728620538917180, 2820257438258466098, 8460772314775398324, 8460772314775398313, 2820257438258466104, 3226986058797383405, 14101287191292330496, 3226986058797383389, 406728620538917125, 8867500935314315644, 11281029753033864514, 14101287191292330525, 11281029753033864518, 5640514876516932337, 406728620538917143, 14101287191292330502, 8867500935314315625, 5640514876516932295, 5640514876516932341, 5640514876516932333, 6047243497055849524, 11281029753033864459, 6047243497055849556, 8460772314775398378, 3226986058797383392, 6047243497055849578, 6047243497055849523, 2820257438258466169, 14101287191292330512, 8867500935314315561, 5640514876516932325]
    format_flag = b"IFEST23{"
    res = []
    for index, value in enumerate(format_flag):
        res.append(value ^ flag_enc[index])
    
    # guess the value o in 'terfav*rit'
    res.append(ord('o')^flag_enc[27])

    # guess the i (film) in 'f**m'
    res.append(ord('i')^flag_enc[13])
    print(f"recover key : {len(set(res))}")

    res = set(res)
    cal_set = {i:dict() for i in res}
    for _, i in enumerate(res):
        for j in range(48, 127):
            value = {j^i: chr(j)}
            cal_set[i].update(value)

    result = []
    for _, i in enumerate(flag_enc):
        x = len(result)
        for j in cal_set.keys():
            try:
                result.append(cal_set[j][i])
            except KeyError:
                pass

        if len(result) == x:
            result.append('*')
    print("here FLAG :", ''.join(result))
